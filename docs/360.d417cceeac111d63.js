"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[360],{4360:(E,h,o)=>{o.r(h),o.d(h,{UsersModule:()=>Y});var Z=o(6814),n=o(4840),f=o(4664),v=o(1904),e=o(4946),p=o(5219),U=o(8031),S=o(553),x=o(9862);let b=(()=>{class s{constructor(t){this.http=t,this.apiUrl=S.N.baseUrl}update(t){return this.http.put(`${this.apiUrl}users`,t)}findUser(t){return this.http.get(`${this.apiUrl}users/${t}`)}static#e=this.\u0275fac=function(r){return new(r||s)(e.LFG(x.eN))};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var g=o(4104),m=o(707);const I=function(){return["/users-settings/edit"]};let F=(()=>{class s{constructor(t,r,i,l){this.messageService=t,this.router=r,this.authService=i,this.userService=l,this.user=new v.n}ngOnInit(){this.loadLoggedInUser()}ngOnDestroy(){this.myUser&&this.myUser.unsubscribe()}loadLoggedInUser(){this.myUser=this.authService.getUser().pipe((0,f.w)(t=>this.userService.findUser(t.id))).subscribe(t=>{console.log("Meu usu\xe1rio detalhado: ",t),this.loggedInUser=t})}static#e=this.\u0275fac=function(r){return new(r||s)(e.Y36(p.ez),e.Y36(n.F0),e.Y36(U.u),e.Y36(b))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-users-settings-list"]],decls:18,vars:6,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["key","tst"],[1,"flex","flex-column","align-items-center","justify-content-center"],[2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"w-full","surface-card","py-8","px-5","sm:px-8",2,"border-radius","53px"],[1,"text-center","mb-5"],["src","assets/demo/images/login/avatar.png","alt","Image","height","100",1,"mb-3","rounded-circle"],[1,"text-900","text-3xl","font-medium","mb-3"],[1,"text-600","font-medium"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","label"," Editar Perfil",1,"btn","btn-primary","mt-3",3,"routerLink"]],template:function(r,i){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-toast",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),e._UZ(8,"img",8),e.TgZ(9,"div",9),e._uU(10),e.qZA(),e.TgZ(11,"div",10),e._uU(12),e.qZA(),e.TgZ(13,"div",10),e._uU(14),e.qZA(),e.TgZ(15,"div",10),e._uU(16),e.qZA(),e._UZ(17,"button",11),e.qZA()()()()()()()),2&r&&(e.xp6(10),e.Oqu(null==i.loggedInUser?null:i.loggedInUser.name),e.xp6(2),e.Oqu(null==i.loggedInUser?null:i.loggedInUser.email),e.xp6(2),e.Oqu(null==i.loggedInUser?null:i.loggedInUser.whatsapp),e.xp6(2),e.Oqu(null==i.loggedInUser||null==i.loggedInUser.profile?null:i.loggedInUser.profile.name),e.xp6(1),e.Q6J("routerLink",e.DdM(5,I)))},dependencies:[n.rH,g.FN,m.Hq]})}return s})();var a=o(95),w=o(3714),y=o(1423);const T=function(){return["/"]},C=[{path:"",component:F},{path:"edit",component:(()=>{class s{constructor(t,r,i,l,c){this.fb=t,this.messageService=r,this.router=i,this.authService=l,this.userService=c,this.user=new v.n,this.userForm=this.fb.group({name:["",a.kI.required],whatsapp:["",a.kI.required],email:["",[a.kI.required,a.kI.email]],oldPassword:[""],password:["",[a.kI.minLength(6)]],confirmPassword:[""]},{validators:this.passwordMatchValidator})}ngOnInit(){this.loadLoggedInUser()}loadLoggedInUser(){this.myUser=this.authService.getUser().pipe((0,f.w)(t=>this.userService.findUser(t.id))).subscribe(t=>{this.loggedInUser=t,this.userForm.patchValue({name:t.name,email:t.email,whatsapp:t.whatsapp})})}passwordMatchValidator(t){t.get("password").value!==t.get("confirmPassword").value?t.get("confirmPassword").setErrors({passwordMismatch:!0}):t.get("confirmPassword").setErrors(null)}onSubmit(){if(console.log("Dados preenchidos: ",this.userForm.value),this.userForm.valid){const{name:t,email:r,whatsapp:i,password:l,confirmPassword:c,oldPassword:z,...B}=this.userForm.value,d={name:t,email:r,password:l,whatsapp:i,confirmPassword:c,oldPassword:z};d.oldPassword||(delete d.password,delete d.oldPassword,delete d.confirmPassword),console.log("User usp",d),this.userService.update(d).subscribe({next:u=>{u&&this.messageService.add({key:"tst",severity:"success",summary:"Sucesso!",detail:"Usu\xe1rio alterado"})},error:u=>{console.error("Erro ao cadastrar usu\xe1rio:",u),this.messageService.add({key:"tst",severity:"error",summary:"Falhou!",detail:`Erro! ${u.error.error}`})},complete:()=>setTimeout(()=>this.userForm.reset())})}}static#e=this.\u0275fac=function(r){return new(r||s)(e.Y36(a.qu),e.Y36(p.ez),e.Y36(n.F0),e.Y36(U.u),e.Y36(b))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-users-settings-form"]],decls:38,vars:7,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["key","tst"],[1,"flex","flex-column","align-items-center","justify-content-center"],[2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"w-full","surface-card","py-8","px-5","sm:px-8",2,"border-radius","53px"],[1,"text-center","mb-5"],["src","assets/demo/images/login/avatar.png","alt","Image","height","50",1,"mb-3"],[1,"text-900","text-3xl","font-medium","mb-3"],[1,"text-600","font-medium"],[3,"formGroup","ngSubmit"],["for","name",1,"block","text-900","font-medium","text-xl","mb-2"],["id","name","formControlName","name","type","text","placeholder","Digite seu nome completo","pInputText","",1,"w-full","md:w-30rem","mb-5",2,"padding","1rem"],["for","email1",1,"block","text-900","text-xl","font-medium","mb-2"],["id","email","formControlName","email","type","text","placeholder","Digite seu email","pInputText","",1,"w-full","md:w-30rem","mb-5",2,"padding","1rem"],["for","whatsapp",1,"block","text-900","font-medium","text-xl","mb-2"],[1,"pi","pi-whatsapp"],["id","whatsapp","formControlName","whatsapp","type","text","placeholder","Digite seu n\xfamero de contato","pInputText","",1,"w-full","md:w-30rem","mb-5",2,"padding","1rem"],["for","oldPassword",1,"block","text-900","font-medium","text-xl","mb-2"],["id","oldPassword","formControlName","oldPassword","placeholder","Sua senha","styleClass","mb-5","inputStyleClass","w-full p-3 md:w-30rem",3,"toggleMask"],["for","password",1,"block","text-900","font-medium","text-xl","mb-2"],["id","password","formControlName","password","placeholder","Sua senha","styleClass","mb-5","inputStyleClass","w-full p-3 md:w-30rem",3,"toggleMask"],["for","confirmPassword",1,"block","text-900","font-medium","text-xl","mb-2"],["id","password","formControlName","confirmPassword","placeholder","Repita a senha","styleClass","mb-5","inputStyleClass","w-full p-3 md:w-30rem",3,"toggleMask"],[1,"flex","align-items-center","justify-content-between","mb-5","gap-5"],["pButton","","pRipple","","label","Atualizar",1,"w-full","p-3","text-xl","mb-2",3,"disabled"],["pButton","","pRipple","","label","Voltar",1,"p-button-secondary","w-full","p-3","text-xl","mt-2",3,"routerLink"]],template:function(r,i){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-toast",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),e._UZ(8,"img",8),e.TgZ(9,"div",9),e._uU(10,"Atualiza\xe7\xe3o de dados"),e.qZA(),e.TgZ(11,"span",10),e._uU(12,"Preencha seus dados"),e.qZA()(),e.TgZ(13,"div")(14,"form",11),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(15,"label",12),e._uU(16,"Nome Completo"),e.qZA(),e._UZ(17,"input",13),e.TgZ(18,"label",14),e._uU(19,"Email"),e.qZA(),e._UZ(20,"input",15),e.TgZ(21,"label",16),e._uU(22," Contato "),e._UZ(23,"i",17),e.qZA(),e._UZ(24,"input",18),e.TgZ(25,"label",19),e._uU(26,"Senha atual"),e.qZA(),e._UZ(27,"p-password",20),e.TgZ(28,"label",21),e._uU(29,"Nova Senha"),e.qZA(),e._UZ(30,"p-password",22),e.TgZ(31,"label",23),e._uU(32,"Repita a nova senha"),e.qZA(),e._UZ(33,"p-password",24)(34,"div",25)(35,"button",26)(36,"br")(37,"button",27),e.qZA()()()()()()()()),2&r&&(e.xp6(14),e.Q6J("formGroup",i.userForm),e.xp6(13),e.Q6J("toggleMask",!0),e.xp6(3),e.Q6J("toggleMask",!0),e.xp6(3),e.Q6J("toggleMask",!0),e.xp6(2),e.Q6J("disabled",i.userForm.invalid),e.xp6(2),e.Q6J("routerLink",e.DdM(6,T)))},dependencies:[n.rH,a._Y,a.Fj,a.JJ,a.JL,g.FN,w.o,a.sg,a.u,m.Hq,y.ro]})}return s})()}];let A=(()=>{class s{static#e=this.\u0275fac=function(r){return new(r||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({imports:[n.Bz.forChild(C),n.Bz]})}return s})();var P=o(4532),J=o(2160),M=o(8027),k=o(1712),L=o(6340),N=o(1312);let Y=(()=>{class s{static#e=this.\u0275fac=function(r){return new(r||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({providers:[p.ez],imports:[Z.ez,A,x.JF,a.u5,g.EV,P.d,w.j,J.kW,a.UX,m.hJ,M.U$,k.U,m.hJ,L.V,N.S,y.gz]})}return s})()}}]);