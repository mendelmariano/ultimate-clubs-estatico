"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[360],{4360:(j,v,r)=>{r.r(v),r.d(v,{UsersModule:()=>E});var F=r(6814),d=r(4840),U=r(4664),x=r(1904),e=r(4946),c=r(5219),b=r(8031),I=r(553),w=r(9862);let y=(()=>{var s;class a{constructor(t){this.http=t,this.apiUrl=I.N.baseUrl}update(t){return this.http.put(`${this.apiUrl}users`,t)}findUser(t){return this.http.get(`${this.apiUrl}users/${t}`)}}return(s=a).\u0275fac=function(t){return new(t||s)(e.LFG(w.eN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),a})();var h=r(4104),p=r(707);const C=function(){return["/users-settings/edit"]};let T=(()=>{var s;class a{constructor(t,o,l,u){this.messageService=t,this.router=o,this.authService=l,this.userService=u,this.user=new x.n}ngOnInit(){this.loadLoggedInUser()}ngOnDestroy(){this.myUser&&this.myUser.unsubscribe()}loadLoggedInUser(){this.myUser=this.authService.getUser().pipe((0,U.w)(t=>this.userService.findUser(t.id))).subscribe(t=>{console.log("Meu usu\xe1rio detalhado: ",t),this.loggedInUser=t})}}return(s=a).\u0275fac=function(t){return new(t||s)(e.Y36(c.ez),e.Y36(d.F0),e.Y36(b.u),e.Y36(y))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users-settings-list"]],decls:18,vars:6,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["key","tst"],[1,"flex","flex-column","align-items-center","justify-content-center"],[2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"w-full","surface-card","py-8","px-5","sm:px-8",2,"border-radius","53px"],[1,"text-center","mb-5"],["src","assets/demo/images/login/avatar.png","alt","Image","height","100",1,"mb-3","rounded-circle"],[1,"text-900","text-3xl","font-medium","mb-3"],[1,"text-600","font-medium"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","label"," Editar Perfil",1,"btn","btn-primary","mt-3",3,"routerLink"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-toast",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),e._UZ(8,"img",8),e.TgZ(9,"div",9),e._uU(10),e.qZA(),e.TgZ(11,"div",10),e._uU(12),e.qZA(),e.TgZ(13,"div",10),e._uU(14),e.qZA(),e.TgZ(15,"div",10),e._uU(16),e.qZA(),e._UZ(17,"button",11),e.qZA()()()()()()()),2&t&&(e.xp6(10),e.Oqu(null==o.loggedInUser?null:o.loggedInUser.name),e.xp6(2),e.Oqu(null==o.loggedInUser?null:o.loggedInUser.email),e.xp6(2),e.Oqu(null==o.loggedInUser?null:o.loggedInUser.whatsapp),e.xp6(2),e.Oqu(null==o.loggedInUser||null==o.loggedInUser.profile?null:o.loggedInUser.profile.name),e.xp6(1),e.Q6J("routerLink",e.DdM(5,C)))},dependencies:[d.rH,h.FN,p.Hq]}),a})();var n=r(95),Z=r(3714),S=r(1423);const M=function(){return["/"]},A=[{path:"",component:T},{path:"edit",component:(()=>{var s;class a{constructor(t,o,l,u,f){this.fb=t,this.messageService=o,this.router=l,this.authService=u,this.userService=f,this.user=new x.n,this.userForm=this.fb.group({name:["",n.kI.required],whatsapp:["",n.kI.required],email:["",[n.kI.required,n.kI.email]],oldPassword:[""],password:["",[n.kI.minLength(6)]],confirmPassword:[""]},{validators:this.passwordMatchValidator})}ngOnInit(){this.loadLoggedInUser()}loadLoggedInUser(){this.myUser=this.authService.getUser().pipe((0,U.w)(t=>this.userService.findUser(t.id))).subscribe(t=>{this.loggedInUser=t,this.userForm.patchValue({name:t.name,email:t.email,whatsapp:t.whatsapp})})}passwordMatchValidator(t){t.get("password").value!==t.get("confirmPassword").value?t.get("confirmPassword").setErrors({passwordMismatch:!0}):t.get("confirmPassword").setErrors(null)}onSubmit(){if(console.log("Dados preenchidos: ",this.userForm.value),this.userForm.valid){const{name:t,email:o,whatsapp:l,password:u,confirmPassword:f,oldPassword:R,...O}=this.userForm.value,m={name:t,email:o,password:u,whatsapp:l,confirmPassword:f,oldPassword:R};m.oldPassword||(delete m.password,delete m.oldPassword,delete m.confirmPassword),console.log("User usp",m),this.userService.update(m).subscribe({next:g=>{g&&this.messageService.add({key:"tst",severity:"success",summary:"Sucesso!",detail:"Usu\xe1rio alterado"})},error:g=>{console.error("Erro ao cadastrar usu\xe1rio:",g),this.messageService.add({key:"tst",severity:"error",summary:"Falhou!",detail:`Erro! ${g.error.error}`})},complete:()=>setTimeout(()=>this.userForm.reset())})}}}return(s=a).\u0275fac=function(t){return new(t||s)(e.Y36(n.qu),e.Y36(c.ez),e.Y36(d.F0),e.Y36(b.u),e.Y36(y))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users-settings-form"]],decls:38,vars:7,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["key","tst"],[1,"flex","flex-column","align-items-center","justify-content-center"],[2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"w-full","surface-card","py-8","px-5","sm:px-8",2,"border-radius","53px"],[1,"text-center","mb-5"],["src","assets/demo/images/login/avatar.png","alt","Image","height","50",1,"mb-3"],[1,"text-900","text-3xl","font-medium","mb-3"],[1,"text-600","font-medium"],[3,"formGroup","ngSubmit"],["for","name",1,"block","text-900","font-medium","text-xl","mb-2"],["id","name","formControlName","name","type","text","placeholder","Digite seu nome completo","pInputText","",1,"w-full","md:w-30rem","mb-5",2,"padding","1rem"],["for","email1",1,"block","text-900","text-xl","font-medium","mb-2"],["id","email","formControlName","email","type","text","placeholder","Digite seu email","pInputText","",1,"w-full","md:w-30rem","mb-5",2,"padding","1rem"],["for","whatsapp",1,"block","text-900","font-medium","text-xl","mb-2"],[1,"pi","pi-whatsapp"],["id","whatsapp","formControlName","whatsapp","type","text","placeholder","Digite seu n\xfamero de contato","pInputText","",1,"w-full","md:w-30rem","mb-5",2,"padding","1rem"],["for","oldPassword",1,"block","text-900","font-medium","text-xl","mb-2"],["id","oldPassword","formControlName","oldPassword","placeholder","Sua senha","styleClass","mb-5","inputStyleClass","w-full p-3 md:w-30rem",3,"toggleMask"],["for","password",1,"block","text-900","font-medium","text-xl","mb-2"],["id","password","formControlName","password","placeholder","Sua senha","styleClass","mb-5","inputStyleClass","w-full p-3 md:w-30rem",3,"toggleMask"],["for","confirmPassword",1,"block","text-900","font-medium","text-xl","mb-2"],["id","password","formControlName","confirmPassword","placeholder","Repita a senha","styleClass","mb-5","inputStyleClass","w-full p-3 md:w-30rem",3,"toggleMask"],[1,"flex","align-items-center","justify-content-between","mb-5","gap-5"],["pButton","","pRipple","","label","Atualizar",1,"w-full","p-3","text-xl","mb-2",3,"disabled"],["pButton","","pRipple","","label","Voltar",1,"p-button-secondary","w-full","p-3","text-xl","mt-2",3,"routerLink"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-toast",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),e._UZ(8,"img",8),e.TgZ(9,"div",9),e._uU(10,"Atualiza\xe7\xe3o de dados"),e.qZA(),e.TgZ(11,"span",10),e._uU(12,"Preencha seus dados"),e.qZA()(),e.TgZ(13,"div")(14,"form",11),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(15,"label",12),e._uU(16,"Nome Completo"),e.qZA(),e._UZ(17,"input",13),e.TgZ(18,"label",14),e._uU(19,"Email"),e.qZA(),e._UZ(20,"input",15),e.TgZ(21,"label",16),e._uU(22," Contato "),e._UZ(23,"i",17),e.qZA(),e._UZ(24,"input",18),e.TgZ(25,"label",19),e._uU(26,"Senha atual"),e.qZA(),e._UZ(27,"p-password",20),e.TgZ(28,"label",21),e._uU(29,"Nova Senha"),e.qZA(),e._UZ(30,"p-password",22),e.TgZ(31,"label",23),e._uU(32,"Repita a nova senha"),e.qZA(),e._UZ(33,"p-password",24)(34,"div",25)(35,"button",26)(36,"br")(37,"button",27),e.qZA()()()()()()()()),2&t&&(e.xp6(14),e.Q6J("formGroup",o.userForm),e.xp6(13),e.Q6J("toggleMask",!0),e.xp6(3),e.Q6J("toggleMask",!0),e.xp6(3),e.Q6J("toggleMask",!0),e.xp6(2),e.Q6J("disabled",o.userForm.invalid),e.xp6(2),e.Q6J("routerLink",e.DdM(6,M)))},dependencies:[d.rH,n._Y,n.Fj,n.JJ,n.JL,h.FN,Z.o,n.sg,n.u,p.Hq,S.ro]}),a})()}];let P=(()=>{var s;class a{}return(s=a).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[d.Bz.forChild(A),d.Bz]}),a})();var J=r(4532),L=r(2160),k=r(8027),N=r(1712),Y=r(6340),z=r(1312);let E=(()=>{var s;class a{}return(s=a).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[c.ez],imports:[F.ez,P,w.JF,n.u5,h.EV,J.d,Z.j,L.kW,n.UX,p.hJ,k.U$,N.U,p.hJ,Y.V,z.S,S.gz]}),a})()}}]);